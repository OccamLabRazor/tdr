EESchema Schematic File Version 4
LIBS:tdr-cache
EELAYER 26 0
EELAYER END
$Descr A4 11693 8268
encoding utf-8
Sheet 1 9
Title ""
Date ""
Rev ""
Comp ""
Comment1 ""
Comment2 ""
Comment3 ""
Comment4 ""
$EndDescr
$Sheet
S 8400 750  1100 4600
U 5BC3F686
F0 "conn_power" 50
F1 "conn_power.sch" 50
F2 "EXT_TRIG" O R 9500 5150 50 
F3 "PULSE_OUT_P" I L 8400 950 50 
F4 "ANALOG_INPUT" O L 8400 4900 50 
F5 "PULSE_OUT_N" I L 8400 1050 50 
F6 "EXT_REF_P" O L 8400 4350 50 
F7 "EXT_REF_N" O L 8400 4450 50 
F8 "REF_CLK_OUT" I L 8400 4000 50 
F9 "ANALOG_TRIG" O L 8400 3750 50 
$EndSheet
$Sheet
S 750  800  1000 6600
U 5BC3F72A
F0 "clock" 50
F1 "clock.sch" 50
F2 "EXT_CLK_P" I R 1750 7100 50 
F3 "EXT_CLK_N" I R 1750 7200 50 
F4 "CLK_DAC_P" O R 1750 4950 50 
F5 "CLK_DAC_N" O R 1750 5050 50 
F6 "CLK_PULSE_P" O R 1750 950 50 
F7 "CLK_PULSE_N" O R 1750 1050 50 
F8 "CLK_SAMPLE_P" O R 1750 2950 50 
F9 "CLK_SEL" I R 1750 6100 50 
F10 "EXT_TRIG" I R 1750 6850 50 
F11 "CLK_SAMPLE_N" O R 1750 3050 50 
F12 "CLK_FPGA" O R 1750 6350 50 
F13 "ANALOG_TRIG_INPUT" I R 1750 5650 50 
F14 "ANALOG_TRIG_REF" I R 1750 5750 50 
F15 "TRIG_SEL1" O R 1750 6600 50 
F16 "TRIG_SEL0" O R 1750 6500 50 
$EndSheet
$Sheet
S 6250 2750 1100 3100
U 5BC41CC8
F0 "comparator" 50
F1 "comparator.sch" 50
F2 "COMP_INPUT" I R 7350 4900 50 
F3 "REF_INPUT" I L 6250 4900 50 
F4 "~LATCH" I L 6250 3050 50 
F5 "LATCH" I L 6250 2950 50 
F6 "COMP_OUT" O R 7350 5650 50 
$EndSheet
$Sheet
S 6250 750  1100 1750
U 5BC2B41E
F0 "output_driver" 50
F1 "output_driver.sch" 50
F2 "PULSE_OUT_P" I R 7350 950 50 
F3 "PULSE_OUT_N" I R 7350 1050 50 
F4 "CLK_IN_P" I L 6250 950 50 
F5 "CLK_IN_N" I L 6250 1050 50 
$EndSheet
Wire Wire Line
	6000 950  6250 950 
Wire Wire Line
	6000 1050 6250 1050
Wire Wire Line
	6000 2950 6250 2950
Wire Wire Line
	6000 3050 6250 3050
Wire Wire Line
	6000 4900 6250 4900
Wire Wire Line
	7350 5650 7600 5650
Text Label 7600 5650 0    50   ~ 0
COMPARATOR_OUTPUT
Text Label 9750 5150 0    50   ~ 0
EXT_TRIG
Wire Wire Line
	9750 5150 9500 5150
Text Label 1850 6850 0    50   ~ 0
EXT_TRIG
Wire Wire Line
	1850 7200 1750 7200
Text Label 1850 7100 0    50   ~ 0
EXT_CLK_P
Wire Wire Line
	1850 7100 1750 7100
Text Label 1850 7200 0    50   ~ 0
EXT_CLK_N
Text Label 8300 4350 2    50   ~ 0
EXT_CLK_P
Text Label 8300 4450 2    50   ~ 0
EXT_CLK_N
Wire Wire Line
	7350 4900 8400 4900
Wire Wire Line
	7350 950  8400 950 
Wire Wire Line
	7350 1050 8400 1050
Wire Wire Line
	1850 6850 1750 6850
Wire Wire Line
	1850 5050 1750 5050
Text Label 1850 4950 0    50   ~ 0
CLK_DAC_P
Wire Wire Line
	1850 4950 1750 4950
Text Label 1850 5050 0    50   ~ 0
CLK_DAC_N
Wire Wire Line
	1850 3050 1750 3050
Text Label 1850 2950 0    50   ~ 0
CLK_SAMPLE_P
Wire Wire Line
	1850 2950 1750 2950
Text Label 1850 3050 0    50   ~ 0
CLK_SAMPLE_N
Wire Wire Line
	1850 1050 1750 1050
Text Label 1850 950  0    50   ~ 0
CLK_PULSE_P
Wire Wire Line
	1850 950  1750 950 
Text Label 1850 1050 0    50   ~ 0
CLK_PULSE_N
Text Label 4850 950  2    50   ~ 0
CLK_PULSE_P
Text Label 4850 1050 2    50   ~ 0
CLK_PULSE_N
Text Label 4850 2950 2    50   ~ 0
CLK_SAMPLE_P
Text Label 4850 3050 2    50   ~ 0
CLK_SAMPLE_N
Text Label 4850 4950 2    50   ~ 0
CLK_DAC_P
Text Label 4850 5050 2    50   ~ 0
CLK_DAC_N
Wire Wire Line
	4850 950  5000 950 
Wire Wire Line
	4850 1050 5000 1050
Wire Wire Line
	4850 2950 5000 2950
Wire Wire Line
	4850 3050 5000 3050
Wire Wire Line
	4850 4950 5000 4950
Wire Wire Line
	4850 5050 5000 5050
Wire Wire Line
	8300 4350 8400 4350
Wire Wire Line
	8300 4450 8400 4450
$Sheet
S 2800 750  1300 6650
U 5BC3F67C
F0 "fpga" 50
F1 "fpga.sch" 50
F2 "D0_DAC" O R 4100 5500 50 
F3 "D1_DAC" O R 4100 5600 50 
F4 "D2_DAC" O R 4100 5700 50 
F5 "D3_DAC" O R 4100 5800 50 
F6 "D4_DAC" O R 4100 5900 50 
F7 "D5_DAC" O R 4100 6000 50 
F8 "D6_DAC" O R 4100 6100 50 
F9 "D7_DAC" O R 4100 6200 50 
F10 "D8_DAC" O R 4100 6300 50 
F11 "D9_DAC" O R 4100 6400 50 
F12 "DAC_SLEEP" I R 4100 5200 50 
F13 "COMPARATOR_INPUT" I R 4100 3750 50 
F14 "REF_CLK_SEL" O L 2800 6100 50 
F15 "UART_TX" O R 4100 6700 50 
F16 "UART_RX" I R 4100 6800 50 
F17 "FPGA_CLK" I L 2800 6350 50 
F18 "ICE_SCK" I R 4100 3900 50 
F19 "ICE_SI" I R 4100 4000 50 
F20 "ICE_SS" I R 4100 4100 50 
F21 "ICE_SO" I R 4100 4200 50 
F22 "ICE_~RESET" I R 4100 4300 50 
F23 "ICE_DONE" I R 4100 4400 50 
F24 "DELAY_SLOAD" I R 4100 1750 50 
F25 "DELAY_~EN" I R 4100 1850 50 
F26 "DELAY_SDIN" I R 4100 1950 50 
F27 "DELAY_SCLK" I R 4100 2050 50 
F28 "SEL1" O L 2800 6600 50 
F29 "SEL0" O L 2800 6500 50 
F30 "TRIG_DAC_SCK" O R 4100 7200 50 
F31 "TRIG_DAC_SDI" O R 4100 7100 50 
F32 "TRIG_DAC_CS" O R 4100 7000 50 
$EndSheet
Wire Wire Line
	4100 5500 5000 5500
Wire Wire Line
	4100 5600 5000 5600
Wire Wire Line
	4100 5700 5000 5700
Wire Wire Line
	4100 5800 5000 5800
Wire Wire Line
	4100 5900 5000 5900
Wire Wire Line
	4100 6000 5000 6000
Wire Wire Line
	4100 6100 5000 6100
Wire Wire Line
	4100 6200 5000 6200
Wire Wire Line
	4100 6300 5000 6300
Wire Wire Line
	4100 6400 5000 6400
Text Label 4250 3750 0    50   ~ 0
COMPARATOR_OUTPUT
Wire Wire Line
	4100 5200 5000 5200
Text Notes 1150 700  0    50   ~ 0
200 mA
Text Notes 5100 650  0    50   ~ 0
170 mA typ, 120 mA  for outputs?
Text Notes 5450 4700 0    50   ~ 0
100 mA
Text Notes 6550 700  0    50   ~ 0
60 mA
Text Notes 6600 2700 0    50   ~ 0
80 mA
Wire Wire Line
	1750 6100 2800 6100
Wire Wire Line
	1750 6350 2800 6350
Text Label 8300 4000 2    50   ~ 0
REF_CLK_OUT
Wire Wire Line
	8300 4000 8400 4000
Wire Wire Line
	4100 1750 5000 1750
Wire Wire Line
	5000 1850 4100 1850
Wire Wire Line
	4100 1950 5000 1950
Wire Wire Line
	5000 2050 4100 2050
$Sheet
S 5000 4750 1000 1850
U 5BC349EC
F0 "dac" 50
F1 "dac.sch" 50
F2 "CLK_P" I L 5000 4950 50 
F3 "CLK_N" I L 5000 5050 50 
F4 "D0" I L 5000 5500 50 
F5 "D1" I L 5000 5600 50 
F6 "D2" I L 5000 5700 50 
F7 "D3" I L 5000 5800 50 
F8 "D4" I L 5000 5900 50 
F9 "D5" I L 5000 6000 50 
F10 "D6" I L 5000 6100 50 
F11 "D7" I L 5000 6200 50 
F12 "D8" I L 5000 6300 50 
F13 "D9" I L 5000 6400 50 
F14 "DAC_SLEEP" I L 5000 5200 50 
F15 "DAC_OUT" O R 6000 4900 50 
$EndSheet
$Sheet
S 5000 750  1000 2700
U 5BC64E97
F0 "delay_pulse" 50
F1 "delay.sch" 50
F2 "~EN" I L 5000 1850 50 
F3 "DELAY0_IN" I L 5000 950 50 
F4 "~DELAY0_IN" I L 5000 1050 50 
F5 "DELAY1_IN" I L 5000 2950 50 
F6 "~DELAY1_IN" I L 5000 3050 50 
F7 "DELAY0_OUT" O R 6000 950 50 
F8 "~DELAY0_OUT" O R 6000 1050 50 
F9 "DELAY1_OUT" O R 6000 2950 50 
F10 "~DELAY1_OUT" O R 6000 3050 50 
F11 "SLOAD" I L 5000 1750 50 
F12 "SDIN" I L 5000 1950 50 
F13 "SCLK" I L 5000 2050 50 
$EndSheet
Text Notes 4600 4600 0    50   ~ 0
TODO: REPLACE DAC WITH SPI?
Wire Wire Line
	1750 6500 2800 6500
Wire Wire Line
	1750 6600 2800 6600
Text Label 8300 3750 2    50   ~ 0
EXT_ANALOG_TRIG
Wire Wire Line
	8300 3750 8400 3750
Text Label 1850 5650 0    50   ~ 0
EXT_ANALOG_TRIG
Wire Wire Line
	1850 5650 1750 5650
Text Label 1850 5750 0    50   ~ 0
ANALOG_TRIG_LEVEL
Wire Wire Line
	1850 5750 1750 5750
Text Label 6150 7300 0    50   ~ 0
ANALOG_TRIG_LEVEL
$Sheet
S 5000 6900 1000 500 
U 5C1101FF
F0 "trig_level_dac" 50
F1 "trig_level_dac.sch" 50
F2 "ANALOG_TRIG_LEVEL" O R 6000 7300 50 
F3 "TRIG_DAC_SCK" I L 5000 7200 50 
F4 "TRIG_DAC_SDI" I L 5000 7100 50 
F5 "TRIG_DAC_CS" I L 5000 7000 50 
$EndSheet
Wire Wire Line
	4100 3750 4250 3750
Wire Wire Line
	6150 7300 6000 7300
Wire Wire Line
	4100 6700 4250 6700
Text Label 4250 6700 0    50   ~ 0
UART_TXD
Text Label 4250 6800 0    50   ~ 0
UART_RXD
Wire Wire Line
	4250 6800 4100 6800
Wire Wire Line
	4100 7000 5000 7000
Wire Wire Line
	5000 7100 4100 7100
Wire Wire Line
	4100 7200 5000 7200
$EndSCHEMATC
